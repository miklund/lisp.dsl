%{
open System
open Microsoft.FSharp.Collections
open Lisp.Statements
%}

%token <int> NUMBER
%token <bool> BOOLEAN
%token <string> IDENTIFIER
%token LPAREN RPAREN
%token END

%start start
%type <Lisp.Statements.Ast> start

%%

start:
	expression END { $1 }

expression:
	| NUMBER { Number($1) }
	| BOOLEAN { Boolean($1) } 
	| LPAREN IDENTIFIER parameters { Call($2, $3) }

parameters:
	| RPAREN { [] }
	| expression parameters { $1 :: $2 }
%%